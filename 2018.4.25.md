
# JavaScriptå¼‚æ­¥

---

å‚è€ƒï¼š
+ [JavaScriptå¼‚æ­¥å‡½æ•°](https://www.w3cplus.com/javascript/asynchronous-functions-101.html)
+ [JavaScriptå¼‚æ­¥ç¼–ç¨‹åŸç†](https://www.w3cplus.com/javascript/javascript-asynchronous-programming.html)
+ [JavaScriptå¼‚æ­¥è¿›åŒ–å²](https://www.w3cplus.com/javascript/JavaScript-asynchronous-evolutionary-history.html)
+ [æœ€åè°ˆä¸€æ¬¡ JavaScript å¼‚æ­¥ç¼–ç¨‹](https://www.w3cplus.com/javascript/finally-talk-JavaScript-asynchronous-programming.html)

## åŸç†

JavaScript çš„æ‰§è¡Œç¯å¢ƒæ˜¯å•çº¿ç¨‹çš„ï¼Œå¼‚æ­¥å°±æ˜¯å®ç°äº‹ä»¶é˜Ÿåˆ—ç®¡ç†ï¼Œå«å»¶æ—¶ï¼š

```
/** 
* @author Barret Lee 
* @email barret.china@gmail.com 
* @description äº‹ä»¶é˜Ÿåˆ—ç®¡ç†ï¼Œå«å»¶æ—¶ 
*/ 
var Q = { 
    // ä¿å­˜é˜Ÿåˆ—ä¿¡æ¯ 
    a: [], 
    // æ·»åŠ åˆ°é˜Ÿåˆ— queue 
    q: function(d){ 
        // æ·»åŠ åˆ°é˜Ÿåˆ—å¦‚æœä¸æ˜¯å‡½æ•°æˆ–è€…æ•°å­—åˆ™ä¸å¤„ç† 
        if(!/function|number/.test(typeof d)) return; 
        Q.a.push(d); 
        // è¿”å›å¯¹è‡ªèº«çš„å¼•ç”¨ 
        return Q; 
    }, 
    // æ‰§è¡Œé˜Ÿåˆ— dequeue 
    d: function(){ 
        var s = Q.a.shift(); 
        // å¦‚æœå·²ç»åˆ°äº†é˜Ÿåˆ—å°½å¤´åˆ™è¿”å› 
        if(!s) return; 
        // å¦‚æœæ˜¯å‡½æ•°ï¼Œç›´æ¥æ‰§è¡Œï¼Œç„¶åç»§ç»­ dequeue 
        if(typeof s === "function") { 
            s(), Q.d(); 
            return; 
        } 
        // å¦‚æœæ˜¯æ•°å­—ï¼Œè¯¥æ•°å­—ä½œä¸ºå»¶è¿Ÿæ—¶é—´ï¼Œå»¶è¿Ÿ dequeue 
        setTimeout(function(){ 
            Q.d(); 
        }, s); 
    } 
}; 
function record(s){ 
    var div = document.createElement("div"); 
    div.innerHTML = s; console.log(s); 
    document.body.appendChild(div); 
} 
Q .q(function(){ 
    record("0 <i style='color:blue'>3s ä¹‹åæå®šï¼Œ0 æŠŠ 1 å«è¿›æ¥</i>"); 
}) 
.q(3000) 
.q(function(){ 
    record("1 <i style='color:blue'>2s ä¹‹åæå®šï¼Œ1 æŠŠ 2 å«è¿›æ¥</i>"); 
}) 
.q(2000) 
.q(function(){ 
    record("2 <span style='color:red'>åé¢æ²¡äººäº†ï¼ŒOKï¼Œå•æ‰€å…³é—¨~</span>");
}) 
.d();
```


## ç”¨æ³•

### åŸºæœ¬ç”¨æ³•

JavaScript é»˜è®¤æƒ…å†µä¸‹ä¸€åˆ‡éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æœä»£ç çš„ä¸€éƒ¨åˆ†æ˜¯ä¾èµ–äºå…¶ä»–çš„ç»“æœï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸åµŒå¥—ä»£ç ã€‚åµŒå¥—å›è°ƒä¸åˆ©äºç»´æŠ¤ã€‚å¼‚æ­¥å‡½æ•°å’Œ Promise å°±æ˜¯ç”¨äºæ›´ç®€æ´ï¼Œæ›´æ‰å¹³åœ°åŒæ­¥æ‰§è¡Œä»£ç ã€‚

+ <code>async</code>å‡½æ•°è¡¨è¾¾å¼: å®šä¹‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°.
+ <code>await</code>å…³é”®è¯: æ”¾åœ¨å›è°ƒçš„ Promise ä¹‹å‰ï¼Œå°†ä¼šæš‚åœæ‰§è¡Œå‡½æ•°ï¼Œç›´åˆ° Promise æ‰§è¡Œæˆ–æ‹’ç»ã€‚
+ <code>try</code>å’Œ<code>catch</code>å—: å¤„ç†é”™è¯¯ã€‚try â€”â€” å°è¯•ä¸€ä¸ªåŠ¨ä½œï¼Œcatch â€”â€” å¦‚æœè¡ŒåŠ¨å¤±è´¥äº†ã€‚å®ƒæ¥å—ä¸€ä¸ª paramterï¼ŒåŒ…å«æŠ›å‡ºçš„ä»»ä½•é”™è¯¯ã€‚

```
async function foo() { 
    await somePromise(); 
    throw Error(â€˜oops!â€™) 
} 
foo() .then((res) => console.log(res)) 
.catch((err) => console.log(err)) // â€˜oops!â€™
```

+ <code>Promise.all()</code>æ–¹æ³•: å¹¶è¡Œæ‰§è¡Œå¤šä¸ª Promiseã€‚
```
function pause500ms() { 
    return new Promise((res) => setTimeout(res, 500)); 
} 
const promise1 = pause500ms(); 
const promise2 = pause500ms(); 
Promise.all([promise1, promise2]).then(() => { 
    console.log("I will be logged after ? ms"); 
});

async function inSequence() { 
    await pause500ms();
    await pause500ms(); 
    console.log("I will be logged after ? ms"); 
}

async function inParallel() { 
    const await1 = pause500ms(); 
    const await2 = pause500ms(); 
    await await1; 
    await await2; 
    console.log("I will be logged after ? ms"); 
}
```

ğŸŒ°
```
function baz() { 
    return new Promise((res) => setTimeout(res, 1000)); 
}
async function foo() { 
    await baz(); 
    return 'foo complete!'; 
} 
async function bar() { 
    const value = await foo(); 
    console.log(value); 
    return 'bar complete!'; 
} 
bar().then((value) => console.log(value)); 

```

é™¤äº†<code>async function() {}</code>ï¼Œasync å…³é”®å­—è¿˜å¯ç”¨äºå…¶ä»–å‡½æ•°è¯­æ³•ã€‚

1. ç®­å¤´å‡½æ•°
```
const jsonPromises = urls.map(async url => { 
    const response = await fetch(url); 
    return response.json(); 
});
```
<code>array.map(func)</code> ä¸åœ¨ä¹æˆ‘æä¾›ç»™å®ƒçš„æ˜¯ä¸æ˜¯å¼‚æ­¥å‡½æ•°ï¼ŒåªæŠŠå®ƒå½“ä½œä¸€ä¸ªè¿”å› Promise çš„å‡½æ•°æ¥çœ‹å¾…ã€‚ å®ƒä¸ä¼šç­‰åˆ°ç¬¬ä¸€ä¸ªå‡½æ•°æ‰§è¡Œå®Œæ¯•å°±ä¼šè°ƒç”¨ç¬¬äºŒä¸ªå‡½æ•°ã€‚

2. å¯¹è±¡æ–¹æ³•

```
const storage = { 
    async getAvatar(name) { 
        const cache = await caches.open('avatars'); 
        return cache.match(`/avatars/${name}.jpg`); 
    } 
}; 
storage.getAvatar('jaffathecake').then(â€¦);
```

3. ç±»æ–¹æ³•
```
class Storage { 
    constructor() { 
        this.cachePromise = caches.open('avatars'); 
    } 
    async getAvatar(name) { 
        const cache = await this.cachePromise; 
        return cache.match(`/avatars/${name}.jpg`); 
    } 
} 
const storage = new Storage();
storage.getAvatar('jaffathecake').then(â€¦);
```


### å…³äº Error
<code>throw new Error</code> çš„ä½œç”¨èŒƒå›´å°±æ˜¯é˜»æ–­ä¸€ä¸ª script æ ‡ç­¾å†…çš„ç¨‹åºè¿è¡Œã€‚

+ <code>window</code> å…¨å±€å¯¹è±¡ä¸Šæœ‰ä¸€ä¸ªä¾¿åˆ©çš„å‡½æ•°ï¼Œ<code>window.error</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ•æ‰åˆ°æ‰€æœ‰çš„é”™è¯¯ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚
```
window.onerror = function(msg, url, line){
    console.log(msg, url, line);
    // å¿…é¡»è¿”å› trueï¼Œå¦åˆ™ Error è¿˜æ˜¯ä¼šè§¦å‘é˜»å¡ç¨‹åº
    return true;
}

setTimeout(function(){
    throw new Error("error");
    // consoleï¼š
    //Uncaught Error: error path/to/ie6bug.html 99  
}, 50);

```
+ å¯¹é”™è¯¯è¿›è¡Œå°è£…å¤„ç†:

```
window.onerror = function(msg, url, line){ 
    // æˆªæ–­ "Uncaught Error: error"ï¼Œè·å–é”™è¯¯ç±»å‹ 
    var type = msg.slice(16); 
    switch(type){ 
        case "TooLarge": 
        console.log("The number is too large"); 
        case "TooSmall": 
        console.log("The number is too Small"); 
        case "TooUgly": 
        console.log("That's Barret Lee~"); 
        // å¦‚æœä¸æ˜¯æˆ‘ä»¬é¢„å®šä¹‰çš„é”™è¯¯ç±»å‹ï¼Œåˆ™åé¦ˆç»™åå°ç›‘æ§ 
        default: 
            $ && $.post && $.post({ 
                "msg": msg, "url": url, "line": line 
        }) 
    } 
    // è®°å¾—è¿™é‡Œè¦è¿”å› trueï¼Œå¦åˆ™é”™è¯¯é˜»æ–­ç¨‹åºã€‚
    return true; 
} 
setTimeout(function(){ 
    if( something ) throw new Error("TooUgly"); 
    // consoleï¼š 
    //That's Barret Lee~ 
}, 50);
```


## <code>setTimeout</code>

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå»¶æ—¶ä¸º n çš„è¯ï¼Œå‡½æ•°ä¼šåœ¨ n æ¯«ç§’ä¹‹åæ‰§è¡Œã€‚ä½†æ˜¯å­˜åœ¨ä¸‰ä¸ªé—®é¢˜ï¼š

### åŠæ—¶æ€§

```
var d = new Date, count = 0, f, timer; 
timer = setInterval(f = function (){ 
    if(new Date - d > 1000) clearInterval(timer), console.log(count); 
    count++; 
}, 0);

var d = new Date, count = 0; 
while(true) { 
    if(new Date - d > 1000) { 
        console.log(count); 
        break; 
    } 
    count++; 
}
```

é€šè¿‡ä»¥ä¸Šä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°å¹¶ä¸æ˜¯åœ¨ n æ¯«ç§’ä¹‹åæ‰§è¡Œ,å¯èƒ½ä¼šæœ‰ä¸€ç‚¹æ—¶é—´çš„å»¶è¿Ÿã€‚

<code>setInterval</code> å’Œ <code>setTimeout</code> å‡½æ•°è¿è½¬çš„æœ€çŸ­å‘¨æœŸæ˜¯ 5ms å·¦å³ã€‚å¦‚æœåµŒå¥—çš„å±‚æ¬¡å¤§äº 5ï¼Œå¹¶ä¸” <code>timeout</code> è®¾ç½®çš„æ•°å€¼å°äº 4 åˆ™ç›´æ¥å– 4ã€‚

å½“ <code>timeout</code> ä¸º 0 çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼æ›¿ä»£:

+ <code>requestAnimationFrame</code> å®ƒå…è®¸ JavaScript ä»¥ 60+å¸§/s çš„é€Ÿåº¦å¤„ç†åŠ¨ç”»ï¼Œè¿è¡Œæ—¶é—´é—´éš”æ¯” <code>setTimeout</code> è¦çŸ­å¾ˆå¤šçš„ã€‚
+ <code>process.nextTick</code> è¿™ä¸ªæ˜¯ NodeJS ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨ä»–å¯ä»¥å‡ ä¹è¾¾åˆ°ä¸Šé¢çœ‹åˆ°çš„ <code>while</code> å¾ªç¯çš„æ•ˆç‡
+ ajax æˆ–è€… æ’å…¥èŠ‚ç‚¹ çš„ <code>readyState</code> å˜åŒ–
+ <code>MutationObserver</code> å¤§çº¦ 2-3ms
+ <code>setImmediate</code>
+ <code>postMessage</code> è¿™ä¸ªç›¸å½“å¿«

### whileå¾ªç¯é˜»å¡

```
var d = new Date; 
setTimeout(function(){ 
    console.log("show me after 1s, but you konw:" + (new Date - d)); 
}, 1000); 
while(1) if(new Date - d > 2000) break;
```

### try..catchæ•æ‰ä¸åˆ°é”™è¯¯

```
try{ setTimeout(function(){ 
    throw new Error("æˆ‘ä¸å¸Œæœ›è¿™ä¸ªé”™è¯¯å‡ºç°ï¼") 
    }, 1000); 
} 
catch(e){ 
    console.log(e.message); 
}
```

## å¸¸è§çš„å¼‚æ­¥æ¨¡å‹

### é«˜é˜¶å‡½æ•°ï¼ˆæ³›å‡½æ•°ï¼‰

```
step1(function(res1){ 
    step2(function(res2){ 
        step3(function(res3){ 
            //... 
        }); 
    }); 
});
```
è§£è€¦ç¨‹åº¦ç‰¹åˆ«ä½ï¼Œå¦‚æœé€å…¥çš„å‚æ•°å¤ªå¤šä¼šæ˜¾å¾—å¾ˆä¹±ï¼è¿™æ˜¯æœ€å¸¸è§çš„ä¸€ç§æ–¹å¼ï¼ŒæŠŠå‡½æ•°ä½œä¸ºå‚æ•°é€å…¥ï¼Œç„¶åå›è°ƒã€‚

### äº‹ä»¶ç›‘å¬

```
E.on("evt", g); 
function f(){ 
    setTimeout(function(){ 
        E.trigger("evt"); 
    }) 
}
```
JS å’Œ æµè§ˆå™¨æä¾›çš„åŸç”Ÿæ–¹æ³•åŸºæœ¬éƒ½æ˜¯åŸºäºäº‹ä»¶è§¦å‘æœºåˆ¶çš„ï¼Œè€¦åˆåº¦å¾ˆä½ï¼Œä¸è¿‡äº‹ä»¶ä¸èƒ½å¾—åˆ°æµç¨‹æ§åˆ¶ã€‚

### å‘å¸ƒ/è®¢é˜…( Pub/Sub )

```
E.subscribe("evt", g);
function f(){
    setTimeout(function () { ã€€ã€€ 
        // fçš„ä»»åŠ¡ä»£ç  ã€€ã€€ 
        E.publish("evt"); 
    }, 1000);
}
```
æŠŠäº‹ä»¶å…¨éƒ¨äº¤ç»™ E è¿™ä¸ªæ§åˆ¶å™¨ç®¡ç†ï¼Œå¯ä»¥å®Œå…¨æŒæ¡äº‹ä»¶è¢«è®¢é˜…çš„æ¬¡æ•°ï¼Œä»¥åŠè®¢é˜…è€…çš„ä¿¡æ¯ï¼Œç®¡ç†èµ·æ¥ç‰¹åˆ«æ–¹ä¾¿ã€‚

### Promise å¯¹è±¡ï¼ˆdeferred å¯¹è±¡ï¼‰
[åŒºåˆ«äºå¼‚æ­¥å‡½æ•°](https://www.w3cplus.com/javascript/JavaScript-asynchronous-evolutionary-history.html)

åœ¨Promises/Aè§„èŒƒä¸­ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸‰ç§çŠ¶æ€ï¼šé»˜è®¤(pending)ã€å®Œæˆ(fulfilled)ã€å¤±è´¥(rejected)ã€‚

Promise å°±åƒä¸€ä¸ªä¸­ä»‹ï¼Œå®ƒæ‰¿è¯ºä¼šå°†ä¸€ä¸ªå¯ä¿¡ä»»çš„å¼‚æ­¥ç»“æœè¿”å›ã€‚é¦–å…ˆ Promise å’Œå¼‚æ­¥æ¥å£ç­¾è®¢ä¸€ä¸ªåè®®ï¼ŒæˆåŠŸæ—¶ï¼Œè°ƒç”¨ <code>resolve</code> å‡½æ•°é€šçŸ¥ Promiseï¼Œå¼‚å¸¸æ—¶ï¼Œè°ƒç”¨ <code>reject</code> é€šçŸ¥ Promiseã€‚å¦ä¸€æ–¹é¢ Promise å’Œ <code>callback</code> ä¹Ÿç­¾è®¢ä¸€ä¸ªåè®®ï¼Œç”± Promise åœ¨å°†æ¥è¿”å›å¯ä¿¡ä»»çš„å€¼ç»™ <code>then</code> å’Œ <code>catch</code> ä¸­æ³¨å†Œçš„ <code>callback</code>ã€‚


+ é»˜è®¤çŠ¶æ€å¯ä»¥å•å‘è½¬ç§»åˆ°å®ŒæˆçŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹å« resolveï¼Œå¯¹åº”çš„æ–¹æ³•æ˜¯ <code>deferred.resolve</code> (promiseOrValue)ï¼›
+ é»˜è®¤çŠ¶æ€è¿˜å¯ä»¥å•å‘è½¬ç§»åˆ°å¤±è´¥çŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹å« rejectï¼Œå¯¹åº”çš„æ–¹æ³•æ˜¯ <code>deferred.reject</code> (reason)ï¼›
+ é»˜è®¤çŠ¶æ€æ—¶ï¼Œè¿˜å¯ä»¥é€šè¿‡ <code>deferred.notify</code> (update) æ¥å®£å‘Šä»»åŠ¡æ‰§è¡Œä¿¡æ¯ï¼Œå¦‚æ‰§è¡Œè¿›åº¦ï¼›
+ çŠ¶æ€çš„è½¬ç§»æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸€æ—¦ä»»åŠ¡ç”±åˆå§‹çš„ <code>pending</code> è½¬ä¸ºå…¶ä»–çŠ¶æ€ï¼Œå°±ä¼šè¿›å…¥åˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ã€‚

ğŸŒ°è®°å½•è·å–æ—¥å¿—ï¼š

```

//Promise 
function logFetch(url) {
    return fetch(url)
        .then(response => response.text())
        .then(text => {
            console.log(text);
        }).catch(err => {
            console.error('fetch failed', err);
        });
}
//å¼‚æ­¥å‡½æ•°
async function logFetch(url) { 
    try { 
        const response = await fetch(url); 
        console.log(await response.text()); 
    } 
    catch (err) { 
        console.log('fetch failed', err); 
    } 
}
```

æ— è®ºæ˜¯å¦ä½¿ç”¨ <code>await</code>ï¼Œå¼‚æ­¥å‡½æ•°éƒ½ä¼šè¿”å› Promiseã€‚è¯¥ Promise è§£ææ—¶è¿”å›å¼‚æ­¥å‡½æ•°è¿”å›çš„ä»»ä½•å€¼ï¼Œæ‹’ç»æ—¶è¿”å›å¼‚æ­¥å‡½æ•°æŠ›å‡ºçš„ä»»ä½•å€¼ã€‚


ğŸŒ°æµå¼ä¼ è¾“å“åº”ï¼š

```
//promise
function getResponseSize(url) { 
    return fetch(url).then(response => { 
        const reader = response.body.getReader(); 
        let total = 0; 
        return reader.read().then(function processResult(result) { 
            if (result.done) return total; 
            const value = result.value; 
            total += value.length; 
            console.log('Received chunk', value); 
            return reader.read().then(processResult); 
        }) 
    }); 
}

//å¼‚æ­¥å‡½æ•°
async function getResponseSize(url) {
    const response = await fetch(url);
    const reader = response.body.getReader();
    let result = await reader.read();
    let total = 0;

    while (!result.done) {
        const value = result.value;
        total += value.length;
        console.log('Received chunk', value);
        // get the next result
        result = await reader.read();
    }

    return total;
}
```

ğŸŒ°æŒ‰é¡ºåºè¾“å‡ºè·å–çš„æ•°æ®ï¼š

è·å–ä¸€ç³»åˆ—ç½‘å€ï¼Œå¹¶å°½å¿«æŒ‰æ­£ç¡®é¡ºåºå°†å®ƒä»¬è®°å½•åˆ°æ—¥å¿—ä¸­ã€‚

```
//promise
function logInOrder(urls) { 
    // fetch all the URLs 
    const textPromises = urls.map(url => { 
        return fetch(url).then(response => response.text()); 
    });

    // log them in order 
    textPromises.reduce((chain, textPromise) => { //ç”¨ reduce æ¥é“¾æ¥ Promise åºåˆ—
        return chain.then(() => textPromise) 
        .then(text => console.log(text)); 
    }, Promise.resolve()); 
}
//å¼‚æ­¥å‡½æ•°ï¼Œå¤ªè¿‡å¾ªåºï¼Œé”™å¤±å¹¶è¡Œæ‰§è¡Œçš„æœºä¼šã€‚
async function logInOrder(urls) { 
    for (const url of urls) { 
        const response = await fetch(url); 
        console.log(await response.text()); 
    } 
}

//æ¨è
async function logInOrder(urls) { 
    // fetch all the URLs in parallel 
    const textPromises = urls.map(async url => { 
        const response = await fetch(url); 
        return response.text(); 
    }); 
    // log them in sequence 
    for (const textPromise of textPromises) { //æ›¿æ¢reduce
        console.log(await textPromise); 
    } 
}
```

## å¤šçº¿ç¨‹æŠ€æœ¯

### <code>Worker</code>
avaScript ä¸­çš„ <code>Worker</code> å¯¹è±¡å¯ä»¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çº¿ç¨‹æ¥å¤„ç†æ•°æ®ï¼Œå¾ˆè‡ªç„¶çš„å¤„ç†äº†é˜»å¡é—®é¢˜ã€‚

```
var worker = new Worker("./outer.js");
worker.addEventListener("message", function(e){
    console.log(e.message);
});
worker.postMessage("data one");
worker.postMessage("data two");

// outer.js
self.addEventListener("message", function(e){
    self.postMessage(e.message);
});

```
å¦‚æœåˆ›å»ºäº†å¤šä¸ª <code>Worker</code>ï¼Œåœ¨ç›‘å¬ <code>onmessage</code> äº‹ä»¶çš„æ—¶å€™è¿˜è¦åˆ¤æ–­ä¸‹ <code>e.target</code> çš„å€¼ä»è€Œå¾—çŸ¥æ•°æ®æºã€‚
<code> Worker </code>å¯ä»¥åˆ›å»º <code>ajax</code> å¯¹è±¡å’Œ <code>WebSocket</code> å¯¹è±¡ï¼Œå°±æ˜¯ç›´æ¥å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚ä½†æ˜¯ä¸èƒ½è®¿é—® DOM çš„ä¿¡æ¯ï¼Œæ›´ä¸èƒ½ç›´æ¥å¤„ç† DOMï¼Œè¿™ä¸ªå…¶å®å¾ˆå¥½ç†è§£ï¼Œä¸»çº¿ç¨‹å’Œ <code>Worker</code> æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œå¦‚æœä¸¤è€…éƒ½å¯ä»¥ä¿®æ”¹ DOMï¼Œé‚£å²‚ä¸æ˜¯å¾—è®¾ç½®ä¸€ä¸ªéº»çƒ¦çš„äº’æ–¥å˜é‡ï¼Ÿï¼è¿˜æœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯ï¼Œåœ¨ <code>Worker</code> ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>importScript</code> å‡½æ•°ç›´æ¥åŠ è½½è„šæœ¬ï¼Œä¸è¿‡è¿™ä¸ªå‡½æ•°æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä¼šå†»ç»“ <code>Worker</code> çº¿ç¨‹ï¼Œç›´åˆ° Script åŠ è½½å®Œæ¯•ã€‚

### <code>SharedWorker</code>

å¯¹äºä¸€äº›åŸºäº <code>WebSocket</code> çš„æ¶æ„ï¼ŒæœåŠ¡å™¨è¦ä¸ºæ¯ä¸€ä¸ªé¡µé¢ç»´æŠ¤ä¸€ä¸ª <code>WebSocket</code> ä»£ç ï¼Œè€Œ <code>SharedWorker</code> èƒ½å®ç°å¤šé¡µé¢é€šç”¨ã€‚å°±æ˜¯æŠŠè¿è¡Œçš„ä¸€ä¸ªçº¿ç¨‹ä½œä¸º Webåå°ç¨‹åºï¼Œå®Œå…¨ä¸éœ€è¦åå°è„šæœ¬å‚ä¸ã€‚
